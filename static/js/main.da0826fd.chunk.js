(this["webpackJsonpare-we-green-on-azure-yet"]=this["webpackJsonpare-we-green-on-azure-yet"]||[]).push([[0],{28:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),s=n.n(r),a=n(17),o=n.n(a),i=(n(28),n(8)),u=n(4),l=n(13),d=n(11),j=n(19),h=n(20),f=n(16),b=n(18),p={completed:"check-circle",failed:"times-circle",exception:"exclamation-circle",pending:"spinner",running:"cog"},m={completed:"green",failed:"red",exception:"orange",pending:"gray",running:"darkgray"},O=["gecko-t/win7-32-azure","gecko-t/win7-32-gpu-azure","gecko-t/win10-64-azure","gecko-t/win10-64-gpu-azure"],g=["mcornmesser@mozilla.com","rthijssen@mozilla.com"];var x=function(){var e=Object(r.useState)(!0),t=Object(d.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)([]),o=Object(d.a)(a,2),x=o[0],k=o[1],v=Object(r.useState)([]),y=Object(d.a)(v,2),z=y[0],w=y[1],I=Object(r.useState)({}),N=Object(d.a)(I,2),E=N[0],S=N[1];return Object(r.useEffect)((function(){g.forEach((function(e){fetch("https://hg.mozilla.org/try/json-pushes?full=1&startdate=2020-11-10&user=".concat(e)).then((function(e){return e.json()})).then((function(e){Object.keys(e).filter((function(t){return"try_task_config.json"===e[t].changesets[0].files[0]})).forEach((function(e){fetch("https://firefox-ci-tc.services.mozilla.com/api/index/v1/tasks/gecko.v2.try.pushlog-id.".concat(e)).then((function(e){if(e.ok)return e.json();throw e})).then((function(e){k((function(t){return[].concat(Object(l.a)(t.filter((function(t){return t!==e.tasks[0].taskId}))),[e.tasks[0].taskId])}))})).catch((function(e){console.error(e)}))}))})).catch((function(e){console.error(e)}))}))}),[]),Object(r.useEffect)((function(){x.forEach((function(e){fetch("https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task-group/".concat(e,"/list")).then((function(e){if(e.ok)return e.json();throw e})).then((function(t){w((function(n){return[].concat(Object(l.a)(n.filter((function(t){return t.taskGroupId!==e}))),Object(l.a)(t.tasks.filter((function(e){return O.includes("".concat(e.task.provisionerId,"/").concat(e.task.workerType))})).map((function(e){return{taskId:e.status.taskId,taskGroupId:e.task.taskGroupId,name:e.task.metadata.name,suite:e.task.metadata.name.split("/")[1],pool:"".concat(e.task.provisionerId,"/").concat(e.task.workerType),state:e.status.state,resolved:e.status.runs&&e.status.runs.length?e.status.runs.slice(-1)[0].resolved:void 0}}))))}))})).catch((function(e){console.error(e)})).finally((function(){s(!1)}))}))}),[x]),Object(r.useEffect)((function(){S((function(e){return Object(u.a)(Object(u.a)({},e),z.reduce((function(e,t){var n=t.suite;return Object(u.a)(Object(u.a)({},e),{},Object(i.a)({},n,O.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(i.a)({},t,z.filter((function(e){return e.suite===n&&e.pool===t}))))}),{})))}),{}))}))}),[z]),Object(c.jsxs)(j.a,{children:[Object(c.jsx)("h1",{className:"text-center",children:"are we green on azure yet?"}),n?Object(c.jsx)("div",{className:"text-center",children:Object(c.jsx)(h.a,{animation:"border",size:"lg"})}):null,Object(c.jsx)("h2",{className:"text-muted text-center",children:"tl;dr"}),Object(c.jsx)(f.a,{children:Object(c.jsx)("tbody",{children:O.sort().map((function(e){return Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"text-right",style:{width:"50%"},children:Object(c.jsx)("h6",{children:e.split("/")[1].replace("-azure","")})}),Object(c.jsx)("td",{style:{width:"50%"},children:Object.keys(E).map((function(t){var n=z.filter((function(n){return n.suite===t&&n.pool===e})).sort((function(e,t){return e.resolved<t.resolved?-1:e.resolved>t.resolved?1:0}));return!!n.length&&"completed"===n.slice(-1)[0].state})).includes(!1)?Object(c.jsx)("h6",{style:{color:"red"},children:"no"}):Object(c.jsx)("h6",{style:{color:"green"},children:"yes"})})]},e)}))})}),Object(c.jsx)("h2",{className:"text-muted text-center",children:"detail"}),Object(c.jsxs)(f.a,{striped:!0,size:"sm",children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{className:"text-muted text-right",children:"suite"}),O.sort().map((function(e){return Object(c.jsx)("th",{className:"text-muted text-center",children:e.split("/")[1].replace("-azure","")},e)}))]})}),Object(c.jsx)("tbody",{children:Object.keys(E).sort().map((function(e){return Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"text-right",children:e}),O.sort().map((function(t){return Object(c.jsx)("td",{className:"text-center",children:E[e][t].sort((function(e,t){return e.resolved<t.resolved?-1:e.resolved>t.resolved?1:0})).slice(-5).map((function(e){return Object(c.jsx)("a",{href:"https://firefox-ci-tc.services.mozilla.com/tasks/".concat(e.taskId),target:"_blank",rel:"noreferrer",title:e.resolved,children:Object(c.jsx)(b.a,{style:{margin:"0 1px"},className:["pending","running"].includes(e.state)?"fa-sm fa-spin":"fa-sm",icon:p[e.state],color:m[e.state]})},e.taskId)}))},t)}))]},e)}))})]}),Object(c.jsxs)("p",{children:["the code for this github page is hosted at: ",Object(c.jsx)("a",{href:"https://github.com/mozilla-platform-ops/are-we-green-on-azure-yet",children:"github.com/mozilla-platform-ops/are-we-green-on-azure-yet"}),".",Object(c.jsx)("br",{}),"the work to green up tests is tracked in: ",Object(c.jsx)("a",{href:"https://bugzilla.mozilla.org/show_bug.cgi?id=1676850",children:"bug 1676850"}),".",Object(c.jsx)("br",{})]})]})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),s(e),a(e)}))},v=(n(34),n(10)),y=n(21),z=n(22);v.b.add(y.a,z.a),o.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(x,{})}),document.getElementById("root")),k()}},[[35,1,2]]]);
//# sourceMappingURL=main.da0826fd.chunk.js.map